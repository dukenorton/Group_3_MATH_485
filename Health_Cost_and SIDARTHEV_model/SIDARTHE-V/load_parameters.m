%%%%% VETTORE MISURE CON I GIORNI DELLE MISURE %%%%%%
%T_measures=[1 3+1  11+1 21+1 27+1 35+1 37+1 39+1 46+1 59+1 74+1 118+1 150+1 162+1 181+1 212+1 220+1 252+1 257+1 274+1 275+1 292+1 307+1 319+1 324+1 327+1 341+1 345+1 354+1 371+1 401+1 431+1 461+1 491+1 521+1 551+1 581+1 611+1 641+1 671+1 707+1];
%T_measures=[1 3+1  11+1 21+1 27+1 35+1 37+1 39+1 46+1 59+1 74+1 118+1 150+1 162+1 181+1 212+1 220+1 252+1 257+1 274+1 275+1 292+1 307+1 319+1 324+1 327+1 341+1 345+1 354+1 384+1 414+1 444+1 474+1 504+1 534+1 564+1 594+1 624+1 654+1 684+1 707+1];
%T_measures=[1 3+1  11+1 21+1 27+1 35+1 37+1 39+1 46+1 59+1 74+1 118+1 150+1 162+1 181+1 212+1 220+1 252+1 257+1 274+1 275+1 292+1 307+1 319+1 324+1 327+1 341+1 345+1 350+1 367+1 375+1 385+1 415+1 445+1 475+1 505+1 535+1 565+1 695+1 707+1];
%T_measures=[1 3+1  11+1 21+1 27+1 35+1 37+1 39+1 46+1 59+1 74+1 118+1 150+1 162+1 181+1 212+1 220+1 252+1 257+1 274+1 275+1 292+1 307+1 319+1 324+1 327+1 341+1 345+1 350+1 367+1 372+1 385+1 415+1 445+1 475+1 505+1 535+1 565+1 695+1 707+1];
%T_measures=[1 3+1  11+1 21+1 27+1 35+1 37+1 39+1 46+1 59+1 74+1 118+1 150+1 162+1 181+1 212+1 220+1 252+1 257+1 274+1 275+1 292+1 307+1 319+1 324+1 327+1 341+1 345+1 350+1 367+1 372+1 385+1 415+1 445+1 475+1 505+1 535+1 565+1 595+1 625+1 655+1 685+1 707+1 ];
%T_measures=[1 3+1  11+1 21+1 27+1 35+1 37+1 39+1 46+1 59+1 74+1 118+1 150+1 162+1 181+1 212+1 220+1 252+1 257+1 274+1 275+1 292+1 307+1 319+1 324+1 327+1 341+1 345+1 350+1 367+1 372+1 385+1 406+1 436+1 466+1 496+1 526+1 556+1 586+1 616+1 646+1 676+1 706+1 707+1 ];
T_measures=[1 3+1  11+1 21+1 27+1 35+1 37+1 39+1 46+1 59+1 74+1 118+1 150+1 162+1 181+1 212+1 220+1 252+1 257+1 274+1 275+1 292+1 307+1 319+1 324+1 327+1 341+1 345+1 350+1 367+1 372+1 385+1 406+1 436+1 466+1 496+1 526+1 556+1 586+1 616+1 646+1 676+1 706+1 707+1 ];

%%  24/02 28/02 11/03 21/03 27/03 04/03 06/04 08/04 15/04  29/04   ...... %%%% 

N_measures=length(T_measures);
NDATA=T_measures(N_measures)-1;

%%%%% PARAMETRI E STRATEGIE %%%%%%




if vaccino==1
    vac=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0  0 0.0 0. 0 0 0 0 0 0 0 0 0 0 0   0 0 0  phi*ones(1,10)  ];

else
    vac=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0  0 0.0 0. 0 0 0 0 0 0 0 0 0 0 0 0 0 0.00*ones(1,10)  ];
end

beta=[ 0.0120 0.0060 0.0060 0.0053 0.0053 0.0053 0.0053 0.0053 0.0053 0.0053 0.0053 0.0053 0.0053 0.0053 0.0053 0.0053 0.0053 0.0053 0.0053 0.0053 0.0053 0.0053 0.0053 0.0053 0.0053 0.0053 0.0053 0.0053 0.0053  0.0053 0.0053 0.0053 0.0053 0.0053 0.0053 0.0053 0.0053 0.0053 0.0053  0.0053 0.0053 0.0053 0.0053];
gamma=[0.4514 0.2821 0.2821 0.1980 0.1089 0.1089 0.1089 0.1089 0.1089 0.1188 0.1188 0.1485 0.1485 0.1485 0.1485 0.1485 0.1485 0.1485 0.1485 0.1485 0.1485 0.1485 0.1485 0.1485 0.1485 0.1485 0.1485 0.1485 0.1485 0.1485 0.1485  0.1485 0.1485 0.1485 0.1485 0.1485 0.1485 0.1485 0.1485  0.1485 0.1485 0.1485  0.1485];
delta=[0.0113 0.0056 0.0056 0.0050 0.0050 0.0050 0.0050 0.0050 0.0050 0.0050 0.0050 0.0050 0.0050 0.0050 0.0050 0.0050 0.0050 0.0050 0.0050 0.0050 0.005 0.0050 0.0050 0.0050 0.0050 0.0050 0.0050 0.0050 0.005 0.0050 0.0050 0.005 0.005 0.0050 0.0050 0.005 0.005 0.0050 0.0050  0.005 0.0050 0.0050  0.005];
epsilon=[0.1703 0.1703 0.1419 0.1419 0.1419 0.1419 0.1992 0.2988 0.2988 0.2988 0.2988 0.6972 0.2490 0.2988 0.2590 0.2294 0.3137 0.2868 0.2868 0.2988 0.2988 0.2988 0.2988 0.2988 0.3988 0.3988 0.1988 0.2988 0.3088 0.2988 0.2988 0.2988 0.2988 0.2988 0.2988 0.2988 0.2988 0.2988 0.2988 0.2988 0.2988 0.2988  0.2988];


theta=[0.3705 0.3705 0.3705 0.3705 0.3705 0.3705 0.3705 0.5000 0.5000 0.5000 0.5000 0.5000 0.5000 0.6000 0.3000 0.6000 0.3700 0.3700 0.3700 0.37 0.3700 0.3700  0.3700 0.3700 0.37 0.3700 0.3700 0.3700 0.37 0.37 0.3700 0.37 0.37 0.3700 0.37 0.3700 0.3700 0.37 0.37 0.3700 0.37 0.37 0.37];    

zeta=[0.1254 0.1254 0.1254 0.0340 0.0340 0.0341 0.0250 0.0250 0.0015 0 0.0001 0.0001 0.0005 0.0020 0.0030 0.0020 0.0046 0.0025 0.0025  0.0025 0.0025 0.0025 0.0025 0.0025 0.0025 0.0025 0.0025 0.0025 0.0025 0.0025 0.0025 0.0025 0.0025 0.0025 0.0025 0.0025 0.0025 0.0025 0.0025 0.0025 0.0025 0.0025 0.0025];
eta=[0.1054 0.1054 0.1054 0.0286 0.0286 0.0286 0.0286 0.0210 0.0015 0 0 0 0.0005 0.0020 0.0031 0.0026 0.0030 0.0013 0.0013 0.001 0.001 0.0015 0.0018 0.0018 0.0018  0.0018 1*[0.0018 0.0018 0.0018 0.0018 0.0018] 0.0018 0.0018 0.0018 0.0018 0.0018 0.0018 0.0018 0.0018 0.0018 0.0018 0.0018 0.0018];

mu=[0.0205 0.0205 0.0205 0.0096 0.0084 0.0036 0.0036 0.0036 0 0 0 0.0036 0.0036 0 0.0024 0.0036 0.060 0.1200 0.1200 0. 0.1200 0.12 0.12  0.12 0.12 0.12 0.12 0.12 0.12 0.12 0.12 0.12 0.12 0.12 0.12 0.12 0.12 0.12 0.12 0.12 0.12 0.12 0.12];

nu=[0.03 0.03 0.01 0.010 0.01 0.008 0.007 0.006 0.005 0.0040 0.025 0.025 0.0026 0.0026 0.0026 0.002 0.002 0.002 0.002 0.02 0.02 0.02 0.02 0.02 0.02 0.02 0.02  0.02 0.02 0.02 0.02 0.02 0.02 0.02 0.02 0.02 0.02 0.02 0.02 0.02 0.02 0.02 0.02];

tau2=[0.00  0.00  0.000  0.000 0.000 0.000 0.035 0.045 0.045 0.045 0.4500  0.45000  0.0200 0.000 0.000 0.00000 0.0000 0.0005 0.0005 1*[0.17 0.170 0.17 0.17  0.17 0.17 0.17 0.17 0.17 0.17 0.17 0.17 0.17 0.17 0.17 0.17 0.17 0.17 0.17] 0.17 0.17 0.17 0.17 0.17 ];

tau1= [0.0200 0.0200 0.0200 0.0200 0.0200 0.0200 0.0200 0.0500 0.0100 0.0100 0      0     0    0    0    0       0.018 0.018 0.018 0.001 0.001 0.005 0.001 0.005 0.005 0.005 0.005 0.005 0.005 0.005 0.005 0.005 0.005 0.005 0.005 0.005 0.005 0.005  0.005 0.005 0.005 0.005 0.005 ];

lambda=[0.0482 0.0482 0.0482 0.1128 0.1128 0.1128 0.1128 0.1128 0.1128 0.1128 0.1128 0.1128 0.1128 0.1128 0.1128 0.1128 0.1128 0.1128 0.1128 0.1128 0.1128 0.1128 0.1128 0.1128 0.1128 1*[0.1128 0.1128 0.112 0.1128] 1*[0.1128 0.1128 0.1128 0.1128 0.1128 0.1128 0.1128  0.1128 0.1128 0.1128 0.1128 0.1128 0.1128] 0.1128];

rho=[0.0342 0.0342 0.0342 0.0170 0.0170 0.0170 0.0200 0.0220 0.0220 0.0450 0.0450 0.0450 0.0200 0.0180 0.0180 0.018 0.0180 0.0180 0.0320 0.0320 0.03200 0.03200 0.03200 0.03200 0.03200 0.03200 0.032 0.03200 0.032 0.032 0.032 0.032 0.03200 0.032 0.032 0.03200  0.03200 0.03200 0.032  0.032 0.032 0.032 0.032];

kappa=[0.0171 0.0171 0.0171 0.0171 0.0171 0.0171 0.0200 0.0220 0.0220 0.0350 0.0350 0.0350 0.0200 0.020 0.020 0.020 0.020 0.0200 0.0200 0.020 0.02 0.02 0.020 0.020 0.020 0.020 0.020 0.020 0.020 0.02 0.02 0.020 0.020 0.02 0.02 0.02 0.020 0.02 0.02 0.02 0.02 0.02  0.02];
csi=[0.00025 0.00025 0.00025 0.00025 0.00025 0.00025 0.00025 0.0083 0.0083 0.0207 0.0120 0.0120 0.0037 0.0019 0.0019 0.00067 0.000670 0.000670 0.000150 0.022 0.0220 0.0220 0.0320 0.0220 0.0220 0.032 0.0320 0.0120 0.022 0.012 0.0022 0.002 0.0220 0.022  0.0220 0.0220 0.022 0.0220 0.022 0.022 0.022 0.022 0.022 ];
sigma=[0.0513 0.0513 0.0513 0.0513 0.0513 0.0513 0.0300 0.0300 0.0600 0.0750 0.0030 0 0 0 0.0240 0.0240 0.0240 0.0240 0.0240 0.0024 0.0240 0.0240 0.0240 0.0240 0.0240 0.0240 0.0240 0.0240 0.0240 0.024 0.0240 0.024 0.024 0.0240 0.024 0.024 0.0240 0.024  0.024 0.024 0.024 0.024 0.024 ];


% 
PAR=[alpha;beta;gamma;delta;epsilon;theta;zeta;eta;mu;nu;tau2;tau1;lambda;rho;kappa;csi;sigma];

%%%%%
alpha=PAR(1,:);
beta=PAR(2,:);
gamma=PAR(3,:);
delta=PAR(4,:);
epsilon=PAR(5,:);
theta=PAR(6,:);
zeta=PAR(7,:);
eta=PAR(8,:);
mu=PAR(9,:);
nu=PAR(10,:);
tau2=PAR(11,:);
tau1=PAR(12,:);
lambda=PAR(13,:);
rho=PAR(14,:);
kappa=PAR(15,:);
csi=PAR(16,:);

r1=epsilon+zeta+lambda;
r2=eta+rho;
r3=theta+mu+kappa;
r4=nu+csi+tau1;
r5=csi+tau2;
R0=(alpha+beta.*epsilon./r2+gamma.*zeta./r3+delta.*epsilon.*eta./(r2.*r4)+delta.*theta.*zeta./(r3.*r4))./r1;

%%%%%%%% Matrici F e CS
FF=zeros(5,5,N_measures-1);
CS=[];
CH=[];
CE=[];
CHdiag=[];

for k=1:N_measures-1
CS=[CS;alpha(k) beta(k) gamma(k) delta(k) 0];
CH=[CH;lambda(k) rho(k) kappa(k) csi(k) sigma(k)];
CHdiag=[CHdiag; 0 rho(k) kappa(k) csi(k) sigma(k)];
CE=[CE; 0 0 0 tau1(k) tau2(k)];

end    
   for k=1:N_measures-1
       for i=1:5
        for j=1:5
    F=[-r1(k) 0 0 0 0;epsilon(k) -r2(k) 0 0 0;zeta(k) 0 -r3(k) 0 0;0 eta(k) theta(k) -r4(k) 0;0 0 mu(k) nu(k) -r5(k)];
    FF(i,j,k)=F(i,j);
       end
    end
   end

b=[1 0 0 0 0]';

V1=[];
V2=[];
V3=[];
V4=[];
V5=[];
frob=[];

% for k=1:N_measures-1
%     V1=[V1 ss(FF(:,:,k),b,[1 0 0 0 0],0)];
%     V2=[V2 ss(FF(:,:,k),b,[0 1 0 0 0],0)];
%     V3=[V3 ss(FF(:,:,k),b,[0 0 1 0 0],0)];
%     V4=[V4 ss(FF(:,:,k),b,[0 0 0 1 0],0)];
%     V5=[V5 ss(FF(:,:,k),b,[0 0 0 0 1],0)];
%     frob=[frob max(real(eig(FF(:,:,k)+b*CS(k,:))))];
% end

T_camp=1;
time=0:T_camp:T_measures/T_camp;
